if LibraryExpanded then

EID._currentMod = "LibraryExpanded"



local CollectibleDesc = {
	[LibraryExpanded.ITEMS.TBOATB.ID] = {
		Description = "책 아이템 사용 시 추가 효과를 발동합니다.#도전방 클리어 시 책 아이템을 하나 소환합니다.",
		Name = "만물서",
		QuoteDesc = "333333333333333333333333333",
	},
	[LibraryExpanded.ITEMS.BLANK_BOOK.ID] = {
		Description = "2222222222222222222",
		Name = "1111111111111111",
		QuoteDesc = "333333333333333333333333333",
	},
	[LibraryExpanded.ITEMS.TBOATB.ID] = {
		Description = "2222222222222222222",
		Name = "1111111111111111",
		QuoteDesc = "333333333333333333333333333",
	},
	[LibraryExpanded.ITEMS.TBOATB.ID] = {
		Description = "2222222222222222222",
		Name = "1111111111111111",
		QuoteDesc = "333333333333333333333333333",
	},
	[LibraryExpanded.ITEMS.TBOATB.ID] = {
		Description = "2222222222222222222",
		Name = "1111111111111111",
		QuoteDesc = "333333333333333333333333333",
	},
	[LibraryExpanded.ITEMS.TBOATB.ID] = {
		Description = "2222222222222222222",
		Name = "1111111111111111",
		QuoteDesc = "333333333333333333333333333",
	},
	[LibraryExpanded.ITEMS.TBOATB.ID] = {
		Description = "2222222222222222222",
		Name = "1111111111111111",
		QuoteDesc = "333333333333333333333333333",
	},
	[LibraryExpanded.ITEMS.TBOATB.ID] = {
		Description = "2222222222222222222",
		Name = "1111111111111111",
		QuoteDesc = "333333333333333333333333333",
	},
	[LibraryExpanded.ITEMS.TBOATB.ID] = {
		Description = "2222222222222222222",
		Name = "1111111111111111",
		QuoteDesc = "333333333333333333333333333",
	},
	[LibraryExpanded.ITEMS.TBOATB.ID] = {
		Description = "2222222222222222222",
		Name = "1111111111111111",
		QuoteDesc = "333333333333333333333333333",
	},
	[LibraryExpanded.ITEMS.TBOATB.ID] = {
		Description = "2222222222222222222",
		Name = "1111111111111111",
		QuoteDesc = "333333333333333333333333333",
	},
	[LibraryExpanded.ITEMS.TBOATB.ID] = {
		Description = "2222222222222222222",
		Name = "1111111111111111",
		QuoteDesc = "333333333333333333333333333",
	},
	[LibraryExpanded.ITEMS.TBOATB.ID] = {
		Description = "2222222222222222222",
		Name = "1111111111111111",
		QuoteDesc = "333333333333333333333333333",
	},
	[LibraryExpanded.ITEMS.TBOATB.ID] = {
		Description = "2222222222222222222",
		Name = "1111111111111111",
		QuoteDesc = "333333333333333333333333333",
	},
	[LibraryExpanded.ITEMS.TBOATB.ID] = {
		Description = "2222222222222222222",
		Name = "1111111111111111",
		QuoteDesc = "333333333333333333333333333",
	},
	[LibraryExpanded.ITEMS.TBOATB.ID] = {
		Description = "2222222222222222222",
		Name = "1111111111111111",
		QuoteDesc = "333333333333333333333333333",
	},
	[LibraryExpanded.ITEMS.TBOATB.ID] = {
		Description = "2222222222222222222",
		Name = "1111111111111111",
		QuoteDesc = "333333333333333333333333333",
	},
	[LibraryExpanded.ITEMS.TBOATB.ID] = {
		Description = "2222222222222222222",
		Name = "1111111111111111",
		QuoteDesc = "333333333333333333333333333",
	},
	[LibraryExpanded.ITEMS.TBOATB.ID] = {
		Description = "2222222222222222222",
		Name = "1111111111111111",
		QuoteDesc = "333333333333333333333333333",
	},
	[LibraryExpanded.ITEMS.TBOATB.ID] = {
		Description = "2222222222222222222",
		Name = "1111111111111111",
		QuoteDesc = "333333333333333333333333333",
	},
	[LibraryExpanded.ITEMS.GLITCH.ID] = {
		Description = "2222222222222222222",
		Name = "1111111111111111",
		QuoteDesc = "333333333333333333333333333",
	},
}

wakaba_krdesc.Library_TBOATB ={
	[CollectibleType.COLLECTIBLE_ANARCHIST_COOKBOOK] = "#{{TBOATB}} Troll bombs now spawn as giga bombs",
	[CollectibleType.COLLECTIBLE_TELEPATHY_BOOK] = "#{{TBOATB}} Homing lasts the whole floor, using again on the same floor causes telekinesis shield and {{Collectible38}} tammy's head use",
	[CollectibleType.COLLECTIBLE_BIBLE] = "#{{TBOATB}} Flying lasts the whole floor, using it again on same floor gives an {{EternalHeart}} eternal heart",
	[CollectibleType.COLLECTIBLE_BOOK_OF_BELIAL] = "#{{TBOATB}} Gives a passive permanent {{DamageSmall}} Damage up, 0.10 per {{TBOATB}} TBOATB",
	[CollectibleType.COLLECTIBLE_BOOK_OF_REVELATIONS] = "#{{TBOATB}} Gives an additional {{HalfSoulHeart}} half a soul heart on use, and another {{Collectible73}} meat cube or {{Collectible207}} ball of bandages on defeating a horseman for each {{TBOATB}} TBOATB",
	[CollectibleType.COLLECTIBLE_SATANIC_BIBLE] = "#{{TBOATB}} Gives an additional {{HalfBlackHeart}} half a black heart on use, and boss room devil deal for each {{TBOATB}} TBOATB",
	[CollectibleType.COLLECTIBLE_BOOK_OF_SECRETS] = "#{{TBOATB}} Shows the location of the {{UltraSecretRoom}} Ultra secret room #{{TBOATB}} Gives the effect of {{Collectible665}} Guppy's Eye for the room",
	[CollectibleType.COLLECTIBLE_BOOK_OF_SHADOWS] = "#{{TBOATB}} Gives shielded tears for the room",
	[CollectibleType.COLLECTIBLE_BOOK_OF_SIN] = "#{{TBOATB}} Drops an additional book of sin pickup for each {{TBOATB}} TBOATB",
	[CollectibleType.COLLECTIBLE_HOW_TO_JUMP] = "#{{TBOATB}} Enemies around isaac will be damaged, and pushed back during the jump and landing #Dmg scales with player damage and number of {{TBOATB}} TBOATB",
	[CollectibleType.COLLECTIBLE_NECRONOMICON] = "#{{TBOATB}} Converts an {{Collectible}} item and {{Trinket}} trinket into their respective missing page",
	[CollectibleType.COLLECTIBLE_MONSTER_MANUAL] = "#{{TBOATB}} On first floor use player gains {{Collectible247}} BFFS effect, further uses activates the book again",
	[CollectibleType.COLLECTIBLE_BOOK_OF_THE_DEAD] = "#{{TBOATB}} On use gives bone related bonuses for the floor",
	[CollectibleType.COLLECTIBLE_LEMEGETON] = "#{{TBOATB}} The book acts as if it was activated again",
	[CollectibleType.COLLECTIBLE_BOOK_OF_VIRTUES] = "#{{TBOATB}} The book acts as if it was activated again",
	--- Mod Item
	[LibraryExpanded.Item.TBOATB.ID] = "#{{TBOATB}} Multiple copies stack depending on the used book",
	[LibraryExpanded.Item.BLANK_BOOK.ID] ="#{{TBOATB}} Each copy of {{TBOATB}} TBOATB makes pages more likely to spawn, and increases the amount of books made",
	[LibraryExpanded.Item.BLANK_BOOK.ID0] ="#{{TBOATB}} For each {{TBOATB}} TBOATB another {{Quality0}} quality 0 book is made",
	[LibraryExpanded.Item.BLANK_BOOK.ID1] = "#{{TBOATB}} For each {{TBOATB}} TBOATB another {{Quality1}} quality 1 book is made",
	[LibraryExpanded.Item.BLANK_BOOK.ID2] = "#{{TBOATB}} For each {{TBOATB}} TBOATB another {{Quality2}} quality 2 book is made",
	[LibraryExpanded.Item.BLANK_BOOK.ID3] = "#{{TBOATB}} For each {{TBOATB}} TBOATB another {{Quality3}} quality 3 book is made",
	[LibraryExpanded.Item.BLANK_BOOK.ID4] = "#{{TBOATB}} For each {{TBOATB}} TBOATB another {{Quality4}} quality 4 book is made",
	[LibraryExpanded.Item.BOOK_OF_ANATOMY.ID] = "#{{TBOATB}} Enemies that die while effected by {{BleedingOut}} bleed have a {{LuckSmall}} luck and {{TBOATB}} TBOATB affected chance to drop hearts",
	[LibraryExpanded.Item.COOKBOOK.ID] = "#{{TBOATB}} Better odds for hearts to spawn and hearts spawned are multiplied by number of {{TBOATB}} TBOATB",
	[LibraryExpanded.Item.ELECTROMAGNETISM_EXPLAINED.ID] = "#{{TBOATB}} Each use has a chance to not count towards max use cap, this chance is effected by {{LuckSmall}} and number of {{TBOATB}} TBOATB",
	[LibraryExpanded.Item.ENCYCLOPEDIA_OF_DISEASES.ID] = "#{{TBOATB}} Gain an additional disease item for each {{TBOATB}} TBOATB",
	[LibraryExpanded.Item.KEY_OF_SOLOMON.ID] = "#{{TBOATB}} Increase the number of purgatory ghosts",
	[LibraryExpanded.Item.KINDLING_BOOK.ID] = "#{{TBOATB}} Creates a circle of {{Burning}} fire",
	[LibraryExpanded.Item.KINDLING_BOOK.ID2] = "#{{TBOATB}} Creates a circle of {{Burning}} fire",
	[LibraryExpanded.Item.POOPAPEDIA.ID] = "#{{TBOATB}} Always spawns poop #{{TBOATB}} Higher chances to learn how to poop #{{TBOATB}} Number of dips and flies is multiplied by number of {{TBOATB}} TBOATB",
	[LibraryExpanded.Item.VMB.ID] = "#{{TBOATB}} Effects caused by the book last the entire floor",
	[LibraryExpanded.Item.CURSED_BOOK.ID] = "#{{TBOATB}} chance to negate negative effects, Stats gained improved by 50%",
	[LibraryExpanded.Item.TECHNOLOGY_BOOK.ID] = "#{{TBOATB}} Effects caused by the book last the entire floor",
	[LibraryExpanded.Item.PHOTO_BOOK.ID] = "#{{TBOATB}} Passive effects caused by the book last the entire floor, Actives get activated multiple times depending on the number of {{TBOATB}} TBOATB",
	[LibraryExpanded.Item.COLORING_BOOK.ID] = "#{{TBOATB}} Enemies will be also be affected by {{Collectible631}} Meat Cleaver",
	[LibraryExpanded.Item.BOMB_BOOK.ID] = "#{{TBOATB}} Will give Giga Bombs equal to the number of {{TBOATB}} TBOATB",
	[LibraryExpanded.Item.BOMBINOMICON.ID] = "#{{TBOATB}} Will give Giga Bombs equal to the number of {{TBOATB}} TBOATB #{{TBOATB}} Explosions will be Giga explosions",
	[LibraryExpanded.Item.WEIRD_BOOK.ID] = "#{{TBOATB}} Multiple books on pickup #{{TBOATB}} Consumed books will have TBOATB synergies",
}

for playerType, birthrightdesc in pairs(BirthrightDesc) do
  EID:addBirthright(playerType, birthrightdesc.Description, birthrightdesc.Name, "ko_kr")
end
for itemID, itemdesc in pairs(CollectibleDesc) do
  local desc = itemdesc.Description
  if itemdesc.StatusEffects then
    for _, eff in ipairs(itemdesc.StatusEffects) do
      desc = desc .. eff
    end
  end
  EID:addCollectible(itemID, desc, itemdesc.Name, "ko_kr")
  if itemdesc.Wisps then
    EID.descriptions["ko_kr"].bookOfVirtuesWisps[itemID] = itemdesc.Wisps
  end
  if itemdesc.Belial and itemdesc.Belial ~= "" then
    EID.descriptions["ko_kr"].bookOfBelialBuffs[itemID] = itemdesc.Belial
  end
	if wakaba and wakaba.intversion and wakaba.intversion >= 10300 then
		wakaba.descriptions["ko_kr"].collectibles[itemID] = {
			targetMod = "LibraryExpanded",
			itemName = itemdesc.Name,
			Description = itemdesc.Description,
			queueDesc = itemdesc.QuoteDesc,
		}
	end
end

local function ModifierConditionTBOATB(descObj) -- descObj contains all informations about the currently described entity
	if LibraryExpanded:GetAllTBOATB() > 0
	and wakaba_krdesc.Library_TBOATB[descObj.ObjSubType] then
		return true
	end
end
local function ModifierCallbackTBOATB(descObj)
	descObj.Description = string.gsub(descObj.Description, "(#{{TBOATB).+", "")
	for _, str in ipairs(wakaba_krdesc.Library_TBOATB[descObj.ObjSubType]) do
		EID:appendToDescription(descObj, "#{{TBOATB}} " .. str)
	end
	return descObj
end

EID:addDescriptionModifier("FF_EIDKR_TBOATB Modifier", ModifierConditionTBOATB, ModifierCallbackTBOATB)

local i_queueLastFrame
local i_queueNow
wakaba_krdesc:AddCallback(ModCallbacks.MC_POST_PLAYER_UPDATE, function (_, player)
	if Options.Language ~= "kr" then return end
	local descTable = CollectibleDesc
	if not descTable then return end

	i_queueNow = player.QueuedItem.Item
	if (i_queueNow ~= nil) then
		for itemID, itemdesc in pairs(descTable) do
			if (i_queueNow.ID == itemID and i_queueNow:IsCollectible() and i_queueLastFrame == nil) then
				local itemName = (itemdesc.Name ~= "" and itemdesc.Name) or i_queueNow.Name
				local queueDesc = itemdesc.QuoteDesc or i_queueNow.Description
				Game():GetHUD():ShowItemText(itemName, queueDesc)
			end
		end
	end
	i_queueLastFrame = i_queueNow
end)

end

